dist: trusty

sudo: required

group: edge

language: python

python:
  - "2.7"
  - "3.2"
  
addons:
  sonarqube:
    organization: "laurelmcintyre-github" 

before_install:
  - sudo pip install codecov
  - sudo pip install nose2
  
#install: pip install -r requirements.txt

script:
  - nose2 --with-coverage mytan
  - coverage run mytan.py 42
  - codecov
  - sonar-scanner
  
after_success: |
  if [ -n "$GITHUB" ]; then
    cd "$TRAVIS_BUILD_DIR"
    pydoc -w $TRAVIS_BUILD_DIR
    mkdir docs
    mv *.html docs/.
    cd docs
    git init
    git checkout -b gh-pages
    git add .
    git -c user.name='travis' -c user.email='travis' commit -m init
    # Make sure to make the output quiet, or else the API token will leak!
    # This works because the API key can replace your password.
    git push -f https://laurelmcintyre:$GITHUB@github.com/laurelmcintyre/python-ci gh-pages 
  fi
